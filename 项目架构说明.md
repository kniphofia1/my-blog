# kniphofia çš„åšå®¢æ¶æ„è¯´æ˜

## ğŸ“ é¡¹ç›®æ ¹ç›®å½•ç»“æ„

```
my-blog/
â”œâ”€â”€ ğŸ“„ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ astro.config.mjs       # Astro ä¸»é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ package.json           # é¡¹ç›®ä¾èµ–ç®¡ç†
â”‚   â”œâ”€â”€ package-lock.json      # ä¾èµ–ç‰ˆæœ¬é”å®š
â”‚   â”œâ”€â”€ tsconfig.json          # TypeScript é…ç½®
â”‚   â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”‚
â”œâ”€â”€ ğŸŒ public/                 # é™æ€èµ„æºç›®å½•ï¼ˆç›´æ¥è®¿é—®ï¼‰
â”‚   â”œâ”€â”€ favicon.ico            # ç½‘ç«™å›¾æ ‡
â”‚   â”œâ”€â”€ favicon.svg            # SVG æ ¼å¼å›¾æ ‡
â”‚   â””â”€â”€ fonts/                 # å­—ä½“æ–‡ä»¶
â”‚       â”œâ”€â”€ atkinson-bold.woff
â”‚       â””â”€â”€ atkinson-regular.woff
â”‚
â”œâ”€â”€ ğŸ’» src/                    # æºä»£ç ç›®å½•ï¼ˆæ ¸å¿ƒï¼ï¼‰
â”‚   â”œâ”€â”€ ğŸ“„ consts.ts           # å…¨å±€å¸¸é‡ï¼ˆç½‘ç«™æ ‡é¢˜ã€æè¿°ï¼‰
â”‚   â”œâ”€â”€ ğŸ“„ content.config.ts   # å†…å®¹é›†åˆé…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ¨ components/         # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ BaseHead.astro     # HTML head æ ‡ç­¾ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Footer.astro       # é¡µè„šç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ FormattedDate.astro # æ—¥æœŸæ ¼å¼åŒ–ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Header.astro       # é¡µå¤´å¯¼èˆªç»„ä»¶ â­
â”‚   â”‚   â””â”€â”€ HeaderLink.astro   # å¯¼èˆªé“¾æ¥ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ content/            # å†…å®¹ç›®å½•ï¼ˆåšå®¢æ–‡ç« ï¼‰
â”‚   â”‚   â””â”€â”€ blog/              # åšå®¢æ–‡ç« é›†åˆ
â”‚   â”‚       â””â”€â”€ æµ·æ´‹ç§‘å­¦ç¬”è®°.md # ä½ çš„æ–‡ç« 
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ¨ layouts/            # é¡µé¢å¸ƒå±€æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ BlogPost.astro     # åšå®¢æ–‡ç« è¯¦æƒ…é¡µå¸ƒå±€
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ pages/              # é¡µé¢è·¯ç”±ï¼ˆåŸºäºæ–‡ä»¶çš„è·¯ç”±ï¼‰
â”‚   â”‚   â”œâ”€â”€ index.astro        # é¦–é¡µ â­ï¼ˆæ–‡ç« åˆ—è¡¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ about.astro        # å…³äºé¡µé¢
â”‚   â”‚   â”œâ”€â”€ blog/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.astro    # åšå®¢åˆ—è¡¨é¡µ
â”‚   â”‚   â”‚   â””â”€â”€ [...slug].astro # åšå®¢æ–‡ç« è¯¦æƒ…é¡µï¼ˆåŠ¨æ€è·¯ç”±ï¼‰
â”‚   â”‚   â””â”€â”€ rss.xml.js         # RSS è®¢é˜…ç”Ÿæˆå™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ–¼ï¸ assets/            # èµ„æºæ–‡ä»¶ï¼ˆå›¾ç‰‡ç­‰ï¼‰
â”‚   â”‚   â””â”€â”€ blog-placeholder-*.jpg
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ¨ styles/             # å…¨å±€æ ·å¼
â”‚   â”‚   â””â”€â”€ global.css         # å…¨å±€ CSS æ ·å¼ â­
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ”§ utils/              # å·¥å…·å‡½æ•°
â”‚       â””â”€â”€ reading-time.ts    # é˜…è¯»æ—¶é—´è®¡ç®—å·¥å…· â­
â”‚
â”œâ”€â”€ ğŸ“¦ node_modules/           # ä¾èµ–åŒ…ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œå‹¿åŠ¨ï¼‰
â”œâ”€â”€ ğŸ”§ .astro/                 # Astro ç¼“å­˜ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ ğŸ“¦ .git/                   # Git ç‰ˆæœ¬æ§åˆ¶ç›®å½•
â”œâ”€â”€ ğŸ“„ .gitignore              # Git å¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ ğŸ”§ .vscode/                # VS Code ç¼–è¾‘å™¨é…ç½®
â””â”€â”€ ğŸ“¦ dist/                   # æ„å»ºè¾“å‡ºç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

---

## ğŸ—ï¸ æ ¸å¿ƒæ¶æ„æµç¨‹

### **1ï¸âƒ£ å†…å®¹ç®¡ç†ï¼ˆContent Layerï¼‰**

```
src/content/blog/
â””â”€â”€ *.md / *.mdx æ–‡ä»¶
    â†“
content.config.tsï¼ˆå®šä¹‰æ•°æ®ç»“æ„ï¼‰
    â†“
Astro Content Collections API
    â†“
ç”Ÿæˆæ–‡ç« æ•°æ®
```

**ä½œç”¨**ï¼š
- å­˜æ”¾æ‰€æœ‰åšå®¢æ–‡ç« 
- ä½¿ç”¨ Markdown/MDX æ ¼å¼
- é€šè¿‡ Frontmatter å®šä¹‰å…ƒæ•°æ®ï¼ˆæ ‡é¢˜ã€æ—¥æœŸç­‰ï¼‰

---

### **2ï¸âƒ£ è·¯ç”±ç³»ç»Ÿï¼ˆRouting Layerï¼‰**

```
src/pages/
â”œâ”€â”€ index.astro        â†’  https://ä½ çš„åŸŸå.com/
â”œâ”€â”€ about.astro        â†’  https://ä½ çš„åŸŸå.com/about
â”œâ”€â”€ blog/
â”‚   â”œâ”€â”€ index.astro    â†’  https://ä½ çš„åŸŸå.com/blog
â”‚   â””â”€â”€ [...slug].astro â†’ https://ä½ çš„åŸŸå.com/blog/æ–‡ç« å
```

**è§„åˆ™**ï¼š
- åŸºäº**æ–‡ä»¶ç³»ç»Ÿ**çš„è·¯ç”±
- `.astro` æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆé¡µé¢
- `[...slug].astro` æ˜¯**åŠ¨æ€è·¯ç”±**ï¼ˆç”¨äºæ–‡ç« è¯¦æƒ…é¡µï¼‰

---

### **3ï¸âƒ£ ç»„ä»¶ç³»ç»Ÿï¼ˆComponent Layerï¼‰**

```
components/
â”œâ”€â”€ Header.astro        â†’ é¡µé¢å¤´éƒ¨ï¼ˆå¯¼èˆªæ ï¼‰
â”œâ”€â”€ Footer.astro        â†’ é¡µé¢åº•éƒ¨
â”œâ”€â”€ BaseHead.astro      â†’ HTML <head> æ ‡ç­¾
â””â”€â”€ HeaderLink.astro    â†’ å¯¼èˆªé“¾æ¥ç»„ä»¶
```

**ä½¿ç”¨æ–¹å¼**ï¼š
```astro
---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<Header />
<main>
  <h1>å†…å®¹</h1>
</main>
<Footer />
```

---

### **4ï¸âƒ£ æ ·å¼ç³»ç»Ÿï¼ˆStyle Layerï¼‰**

```
src/styles/global.css        â†’ å…¨å±€æ ·å¼
src/pages/index.astro        â†’ é¡µé¢çº§æ ·å¼ï¼ˆ<style> æ ‡ç­¾ï¼‰
src/components/Header.astro  â†’ ç»„ä»¶çº§æ ·å¼ï¼ˆ<style> æ ‡ç­¾ï¼‰
```

**CSS å˜é‡ç³»ç»Ÿ**ï¼š
```css
:root {
  --accent: #2337ff;         /* ä¸»é¢˜è‰² */
  --text-primary: rgb(...);   /* ä¸»æ–‡æœ¬è‰² */
  --text-secondary: rgb(...); /* æ¬¡è¦æ–‡æœ¬è‰² */
}
```

---

## ğŸ”§ å…³é”®æ–‡ä»¶è¯¦è§£

### **1. astro.config.mjs** - Astro é…ç½®æ–‡ä»¶

```javascript
import { defineConfig } from 'astro/config';

export default defineConfig({
  site: 'https://example.com',     // ç½‘ç«™åœ°å€
  integrations: [
    mdx(),                          // MDX æ”¯æŒ
    sitemap()                       // ç½‘ç«™åœ°å›¾
  ]
});
```

**ä½œç”¨**ï¼šé…ç½®ç½‘ç«™åŸºæœ¬è®¾ç½®å’Œæ’ä»¶

---

### **2. src/consts.ts** - å…¨å±€å¸¸é‡

```typescript
export const SITE_TITLE = 'kniphofiaçš„bolg';
export const SITE_DESCRIPTION = 'è®°å½•å­¦ä¹ å¿ƒå¾—ä¸çŸ¥è¯†ç§¯ç´¯çš„åšå®¢';
```

**ä½œç”¨**ï¼šå®šä¹‰ç½‘ç«™æ ‡é¢˜å’Œæè¿°ï¼Œå¯åœ¨ä»»ä½•åœ°æ–¹å¯¼å…¥ä½¿ç”¨

---

### **3. src/content.config.ts** - å†…å®¹é›†åˆé…ç½®

```typescript
import { defineCollection, z } from 'astro:content';

const blog = defineCollection({
  loader: glob({ base: './src/content/blog', pattern: '**/*.{md,mdx}' }),
  schema: z.object({
    title: z.string(),
    description: z.string(),
    pubDate: z.coerce.date(),
    heroImage: image().optional(),
  }),
});

export const collections = { blog };
```

**ä½œç”¨**ï¼š
- å®šä¹‰åšå®¢æ–‡ç« çš„æ•°æ®ç»“æ„
- éªŒè¯ Frontmatter æ ¼å¼
- è‡ªåŠ¨åŠ è½½æ‰€æœ‰æ–‡ç« 

---

### **4. src/pages/index.astro** - é¦–é¡µ

```astro
---
import { getCollection } from 'astro:content';
import { getReadingTime, formatWordCount } from '../utils/reading-time';

// è·å–æ‰€æœ‰æ–‡ç« 
const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) =>
  b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<html>
  <head><!-- ... --></head>
  <body>
    <Header />
    <main>
      <!-- æ–‡ç« åˆ—è¡¨ -->
      {sortedPosts.map((post) => (
        <article>
          <a href={`/blog/${post.id}/`}>
            <h2>{post.data.title}</h2>
          </a>
          <time>{post.data.pubDate.toLocaleDateString('zh-CN')}</time>
        </article>
      ))}
    </main>
    <Footer />
  </body>
</html>
```

**ä½œç”¨**ï¼š
- æ˜¾ç¤ºæ‰€æœ‰æ–‡ç« åˆ—è¡¨
- è‡ªåŠ¨æŒ‰æ—¥æœŸæ’åº
- æ˜¾ç¤ºå­—æ•°å’Œé˜…è¯»æ—¶é—´

---

### **5. src/utils/reading-time.ts** - å·¥å…·å‡½æ•°

```typescript
export function getReadingTime(content: string): ReadingTimeStats {
  // 1. ç§»é™¤ Markdown è¯­æ³•
  const text = content
    .replace(/```[\s\S]*?```/g, '')     // ç§»é™¤ä»£ç å—
    .replace(/`[^`]+`/g, '')            // ç§»é™¤è¡Œå†…ä»£ç 
    .replace(/\[([^\]]+)\]\([^)]+\)/g, '$1') // ç§»é™¤é“¾æ¥
    // ... æ›´å¤šæ¸…ç†

  // 2. ç»Ÿè®¡ä¸­è‹±æ–‡
  const chineseChars = (text.match(/[\u4e00-\u9fa5]/g) || []).length;
  const englishWords = (text.match(/[a-zA-Z]+/g) || []).length;

  // 3. è®¡ç®—é˜…è¯»æ—¶é—´
  const words = chineseChars + englishWords;
  const minutes = Math.ceil(chineseChars / 400 + englishWords / 200);

  return { words, minutes, text: `${minutes} min read` };
}
```

**ä½œç”¨**ï¼šæ™ºèƒ½è®¡ç®—æ–‡ç« å­—æ•°å’Œé˜…è¯»æ—¶é—´

---

## ğŸ”„ æ•°æ®æµåŠ¨è¿‡ç¨‹

### **åˆ›å»ºæ–°æ–‡ç« çš„æµç¨‹ï¼š**

```
1. åœ¨ src/content/blog/ åˆ›å»º article.md
   â†“
2. Astro è‡ªåŠ¨æ‰«æå¹¶åŠ è½½æ–‡ç« 
   â†“
3. content.config.ts éªŒè¯æ•°æ®æ ¼å¼
   â†“
4. getCollection('blog') è·å–æ‰€æœ‰æ–‡ç« 
   â†“
5. pages/index.astro æ¸²æŸ“æ–‡ç« åˆ—è¡¨
   â†“
6. pages/blog/[...slug].astro æ¸²æŸ“æ–‡ç« è¯¦æƒ…
```

---

## ğŸ¨ æ ·å¼å±‚å é¡ºåº

```
1. global.cssï¼ˆå…¨å±€æ ·å¼ï¼‰        â†’ æœ€ä½ä¼˜å…ˆçº§
2. layouts/*.astroï¼ˆå¸ƒå±€æ ·å¼ï¼‰    â†’ ä¸­ç­‰ä¼˜å…ˆçº§
3. pages/*.astroï¼ˆé¡µé¢æ ·å¼ï¼‰     â†’ è¾ƒé«˜ä¼˜å…ˆçº§
4. components/*.astroï¼ˆç»„ä»¶æ ·å¼ï¼‰â†’ å¯é€šè¿‡ scoped é™åˆ¶ä½œç”¨åŸŸ
```

---

## ğŸš€ æ„å»ºå’Œéƒ¨ç½²æµç¨‹

### **å¼€å‘æ¨¡å¼**ï¼š
```bash
npm run dev
â†’ å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆç«¯å£ 4323ï¼‰
â†’ æ”¯æŒçƒ­é‡è½½ï¼ˆHMRï¼‰
â†’ å®æ—¶é¢„è§ˆä¿®æ”¹
```

### **ç”Ÿäº§æ„å»º**ï¼š
```bash
npm run build
â†’ ç”Ÿæˆé™æ€ HTML åˆ° dist/ ç›®å½•
â†’ ä¼˜åŒ–å›¾ç‰‡ã€å‹ç¼©ä»£ç 
â†’ ç”Ÿæˆ sitemap.xml
```

### **éƒ¨ç½²æµç¨‹**ï¼š
```
æœ¬åœ°ä¿®æ”¹ â†’ Git Push â†’ GitHub â†’ Vercel è‡ªåŠ¨æ£€æµ‹ â†’ æ„å»º â†’ éƒ¨ç½²å®Œæˆ
```

---

## ğŸ“Š å…³é”®æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç”¨é€” | ç‰ˆæœ¬ |
|------|------|------|
| **Astro** | é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ | v5.17.1 |
| **MDX** | Markdown + JSX æ”¯æŒ | @astrojs/mdx |
| **TypeScript** | ç±»å‹å®‰å…¨ JavaScript | - |
| **Vite** | æ„å»ºå·¥å…·å’Œå¼€å‘æœåŠ¡å™¨ | å†…ç½® |
| **Zod** | æ•°æ®éªŒè¯ï¼ˆFrontmatterï¼‰ | å†…ç½® |

---

## ğŸ¯ æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **é™æ€ä¼˜å…ˆ**ï¼šæ‰€æœ‰å†…å®¹é¢„æ¸²æŸ“ä¸º HTMLï¼Œæ€§èƒ½æä½³
2. **å†…å®¹å³ä»£ç **ï¼šæ–‡ç« å°±æ˜¯æ–‡ä»¶ï¼Œç‰ˆæœ¬æ§åˆ¶å‹å¥½
3. **ç»„ä»¶åŒ–**ï¼šå¯å¤ç”¨çš„ Astro ç»„ä»¶ç³»ç»Ÿ
4. **é›¶ JS é»˜è®¤**ï¼šæ²¡æœ‰äº¤äº’éœ€æ±‚çš„é¡µé¢ä¸å‘é€ JavaScript
5. **æŒ‰éœ€åŠ è½½**ï¼šåªåœ¨éœ€è¦æ—¶åŠ è½½äº¤äº’å¼ç»„ä»¶

---

## ğŸ“ ä¿®æ”¹å»ºè®®

### **ä¿®æ”¹ç½‘ç«™æ ‡é¢˜å’Œæè¿°**ï¼š
â†’ ç¼–è¾‘ `src/consts.ts`

### **ä¿®æ”¹å¯¼èˆªæ é“¾æ¥**ï¼š
â†’ ç¼–è¾‘ `src/components/Header.astro`

### **ä¿®æ”¹é…è‰²æ–¹æ¡ˆ**ï¼š
â†’ ç¼–è¾‘ `src/styles/global.css` ä¸­çš„ `:root` å˜é‡

### **åˆ›å»ºæ–°æ–‡ç« **ï¼š
â†’ åœ¨ `src/content/blog/` åˆ›å»ºæ–°çš„ `.md` æ–‡ä»¶

### **è‡ªå®šä¹‰é¦–é¡µå¸ƒå±€**ï¼š
â†’ ç¼–è¾‘ `src/pages/index.astro`

---

## ğŸ“ å­¦ä¹ è¦ç‚¹

- **Astro ç»„ä»¶** = HTML + CSS + JavaScriptï¼ˆéƒ½åœ¨ `.astro` æ–‡ä»¶é‡Œï¼‰
- **Frontmatter**ï¼ˆ--- åŒ…å›´çš„éƒ¨åˆ†ï¼‰å®šä¹‰æ–‡ç« å…ƒæ•°æ®
- **åŠ¨æ€è·¯ç”±** `[...slug]` å¯ä»¥åŒ¹é…ä»»æ„ URL è·¯å¾„
- **getCollection()** æ˜¯è·å–å†…å®¹é›†åˆçš„æ ¸å¿ƒ API
- **CSS ä½œç”¨åŸŸ**ï¼šç»„ä»¶å†…çš„ `<style>` é»˜è®¤æ˜¯ scopedï¼ˆä½œç”¨åŸŸéš”ç¦»ï¼‰

---

**è¿™å°±æ˜¯ä½ çš„åšå®¢å®Œæ•´æ¶æ„ï¼** (ï¿£â–½â–½ï¿£)ï½„
